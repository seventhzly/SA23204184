<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="By SA23204184 郑李洋" />

<meta name="date" content="2023-12-11" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">By SA23204184 郑李洋</h4>
<h4 class="date">2023-12-11</h4>



<div id="hw0" class="section level2">
<h2>hw0</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.2</code></pre>
</div>
<div id="example1" class="section level2">
<h2>example1</h2>
<p>在iris数据集中提取length列和width列，然后把width看做自变量，length看做因变量，做线性回归，用Plot函数画出线性回归的四张图。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>length<span class="ot">&lt;-</span>iris<span class="sc">$</span>Sepal.Length</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>width<span class="ot">&lt;-</span>iris<span class="sc">$</span>Sepal.Width</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>lm1<span class="ot">&lt;-</span><span class="fu">lm</span>(length <span class="sc">~</span> width)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>lm1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = length ~ width)
## 
## Coefficients:
## (Intercept)        width  
##      6.5262      -0.2234</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">head</span>(iris))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.3.1 by xtable 1.8-4 package
## % Wed Dec 13 20:55:31 2023
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrrrrl}
##   \hline
##  &amp; Sepal.Length &amp; Sepal.Width &amp; Petal.Length &amp; Petal.Width &amp; Species \\ 
##   \hline
## 1 &amp; 5.10 &amp; 3.50 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   2 &amp; 4.90 &amp; 3.00 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   3 &amp; 4.70 &amp; 3.20 &amp; 1.30 &amp; 0.20 &amp; setosa \\ 
##   4 &amp; 4.60 &amp; 3.10 &amp; 1.50 &amp; 0.20 &amp; setosa \\ 
##   5 &amp; 5.00 &amp; 3.60 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   6 &amp; 5.40 &amp; 3.90 &amp; 1.70 &amp; 0.40 &amp; setosa \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
</div>
<div id="example2" class="section level2">
<h2>example2</h2>
<p>对x赋[-10,10]之间的值，构造函数<span class="math inline">\(y=\frac{1}{1+e^{-0.5\times x+1}
}\)</span>，做散点图。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>y<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">pch=</span><span class="dv">15</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="fu">as.expression</span>(<span class="fu">substitute</span>(y<span class="sc">==</span><span class="fu">over</span>(<span class="dv">1</span>,<span class="dv">1</span><span class="sc">+</span>e<span class="sc">^</span>(beta<span class="sc">*</span>x<span class="sc">+</span>alpha)),<span class="fu">list</span>(<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">beta=</span><span class="sc">-</span><span class="fl">0.5</span>))))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example3" class="section level2">
<h2>example3</h2>
<p>对iris数据集里的length和width两列数据做散点图和密度曲线。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>iris <span class="ot">&lt;-</span> datasets<span class="sc">::</span>iris</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width)) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> iris<span class="sc">$</span>Species)) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;散点图&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>plot1 </span></code></pre></div>
<pre><code>## Warning: Use of `iris$Species` is discouraged.
## ℹ Use `Species` instead.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris,<span class="fu">aes</span>(Sepal.Width))<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Species,<span class="at">fill =</span> Species),<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Density 密度曲线&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.8</span>))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>plot2</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABPlBMVEUAAAAAADoAAGYAOmYAOpAAZrYAujgxq5w1hMk6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZrY6kNtNTU1NTW5NTY5NbqtNjsheqOthnP9mAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmZmZmkJBmtrZmtv9rt8htqLluTU1ubqtumqluq+Rvq7twvM110pF/3JuEyeuOTY6Obm6ObquOyP+QOgCQOjqQOmaQkDqQtpCQ29uQ2/+mw/Wo6+upptarbk2rbm6rbo6rq8ir5P+sibauq9uwzf+2ZgC2Zjq2kDq2kJC2tma225C2/7a2/9u2///Ijk3I///JhDXJ6+vbkDrbtmbb25Db29vb/7bb/9vb///kq27kyI7k///r6+vysKz4dm37urb/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8c8UZtAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARrElEQVR4nO3dj3/bRhUAcDXE9tKOUIcxnAZGB07BzY8BS9nwVn41dYFu7jbDRsZSxzGeq///H+DenX6cdE+6d9LJlux7H0jsy022vn062ae7k+e7yA1v3W+g7uGANOGANNEIIC/vqScVeMFPi3tVcyBPjrg0UQUBsrhbtQP6OvHMSz9WvSSO4KHVfVoh0PICduvOMLPC4sFwedFVy+WdDjmCXEl6hUBytpWNlQL12c+Z18+tkwLyxF57CIkf0YW/eKFNHX8NQP5k94onE/u1ePDxHk+pCc+sxYM/svLWqAW1WuH7i/In/CFnkJ86rqS/WYrVA83vigOJQS0Od8b+aPdqxn6x/weHGDwL6gZ7LwAioLgFSgNFZzF7WbR6oMVhHwjgKXvogwd/HrVBUDq/N47fotwmp07x6hFntwVaE9BE7FI3BIIjrh830uwYC48w2N/U+5VPYmobJJXYibUcYtAMQYRA7OGINUIh0Pze58ER5nvpRkXTBgWlzfygGDfSwSElA8H5KwRaXvwyPsKkk5X0VH2W+sTU3DYITvPLC5ZCM5YyUhvEEiv6HDTxoiMsBRSe65N/9JJ/8Wzm0Ho+KMJDOK+HGTTyoBFiQMJmvhd/Vkp+cBafAyOiZCMdtEDRDytRu68aEPI5LIz4JB88VxoetbqNqCXQBPm+sa6oIdB8LzjJ1SJqCFSvcECacECacECacECaKAR0bVJsVNlKsdVNOyAHVK7YATmgcsUbArQ49LydMVo5+ua7zUC83yTsp3QZpBbzLFk8GC6OPvLuDK8hoSCf2K87Q/gbf37tz6Q0o256M4B4F6UPItCf+6k/6kK3P3Rhznb/zYD48+vF0Vi6GkDc9GYAQU9u2EW5fPIBdE0yDdH6sJ/i+afwy3jTmwLk+0Gvtu+PfgpNNhxc+5BWAMSff+DP95ChAY0C6rEospEZP3BGfQCCDDriLU2cQfw5rzxTOuOaBNTrPf/kOSpEOYtBI33YYgRfQZvDJKANmt97KdogVgw4DQd6zoBQIcrnID784WF4FoNjST6LQfGo4Wcx5lMUKAjRDG/s56AACBNyQL7wKQlUoHITgRAhBxT4OKDsYgekKZaAVCEHFPgUBZqiUeJdbxzQjRSvg9+bBNQOfJoMdF1dtNtnvc4ncvQMtzB9jcS03LsyBaKjm1Zun5/3Tk87UgYpKdSEDCr6UtrK7QCo44DwYuYDQKcOCC8OfYRQAJQW2mIg8AmBOg5ILZaATisH+gcy+LEJQIGPDJQSsgO0eK95QHICVQQ0g0HqI897i/1owYNWVNTSb7oOQKEPCFUA9GLofw2XPb7sswyCB6M+FM3v+8snw7oDJRKoIqD5ntediOlX711NYPJDF4qCaY7NAjrtVNIGzff/1Q3aIJFBUPT3bgMyKO1TCdAoaHC8Ply65y0PFMFl1of95gIlhbb1c1A75RN+ZXVAolhJIAeULHZA+ZURHwkoIeSAygJtZKc9BnSMH2M2v/2ZFa8RCPMpCtRGo8S7bgKQLKQFOpfiLPi9CUBpn9Nj/DzmgByQUoz6OKC42AHlV0abaACKhRyQBkgSSmwk/hC46UCqDwVoCt8rhNAGA7XPigJNp/E3rYJAwUj8oDjxTKm9TiDERw8Ufy2dWsqgxgFhQtK30hhoSgN6MfTn+9DV2vUnb+/8E7peYV4ULFQI/a8ciHfEsr/GVI0Fkro1iEAztut99uN60p+0+EUgmCq1f8VAWnxu0NFYdOUn5pKtGajN9gLz0QEl+n1upiSgxdFnR2Nx3WfS5ReBgIQvBQbXgN5iz8TFoMSyRc0ESvoQgfzJ+122+7ANTjDf/0Zk0MxLZVBTgBAhHCjuM8wFmt8d+uK6DyMYxW3QzjjVBhkAff/bL/jvVwc//htVwgCofV4IKO1DBCryrjVAtwfvcKDbn3zH/me6TX0pAKE+uUBTBej1NN7gKoHe/PXNXzjQt4+jXLI6yrV9dnbWO86MDj7aFRnKOpU2qES73JvMAWJEAdCH4aPi/xZIKfx7m2eQkj9w/WIab3GVh5iPZFDRl8oAwn0EkPqFvq5AFbVBhYAQHwlo1Z32APT977+r6CwGA6OPSUCh0DXSQnOg9NVB47dXx2/zPIGMgRCfGKiHRol33Tgg1IdfZOZCvedSFBwpixevAUj0JTqgzFICkCKE+2wwUO/UCGj6OhuIC20SUNBbbwI0dUAaoJttA+qdaoASQtN8IBDaaiD4iLhFQOEFQwOgGwtAi6PxtfRYelBHoN6pCdCNDogJbU4GRVecqUDPSgPxyz7fHI2/fHvn8wtv5+EQLmq8veftXiUu/zQMKBR6RgG6meYB8cs+zOJL3uvMV1uEPvvlE/HgK3/yo2DiTwOBnj27vOyVBOKXfQCoy6exvOAu94MHsy68v4l657w1AYmOLQOgy/JA/LKPAIozKASCDJp53dpkkCEQ+JQHgss+AmgZtUEhEL/88zKY+FMXoN4pEYj7UIBuiGexSddXhirU6iwWJxAFSPhwIUtAcNOl9G1xtgToGQmowM6sAah3SgE67YQ+WwQkJRAB6NIB5QENYiAmpAXaiE572ccyUOLyTzGJjOK6Ag0GJx0HlAd0YggkCTUVKLh+TgJiPlsHFI4vcEAZpckEygcCnxO5lSYAxULVAMFq59QoApRKIAKQnEI1AArvvECJegJFQhUeYsFtu3VRNZDwqR2QuOsEPnOhxEuJ0rSPGRDv8lgzECwdg1ct+VK8NBoiRwEKfIyBQqGKgHjm5ORPqRGj0SjUnLGtUQweieg8jaKHrdVqe/HWVCSA+M1dIEhpZJxBagLlZFCYQLXMIFqsCEgSeooLpdvuac77qPMHxXiQbmOBFkefiYNMvbVL2Ze6lgcxE4BiH3Ogm2n2+6hvBrUdUG7xNepDAoqF6gA02b2akD5HG74UnkCZQLKPOVByLnSJd42cxR7A/d2ie27mhslLyT4lgPAT/UqBjsYshyoAOkN9qgJKTBYv/q7RQ4x9E5tZP8Ta52ZACZ96ARkE/aXa5YAioaf4h+nGA7Xb5xJQYgZUVUDybPqC7zpRHAPNKvigyKcWbggQv9EkMagvxU9gRkCDR6WBpNn0xd51srjKL6ttq0CYEN7RiMyxM3jXqeL4EBulB85kBxXofJOAFta/rAafEM9QHxxocJICCoVqAGQSpJcKP0GvHug1LuSAKgZaXni736A3HC/0UtFXsDPUBwVi53grQPhBVhJoedGd71+p94ou+FJtS0CB0FO8Y3qVQGJ8Pu1kTwE6TwEpq9pWCYQKWcmgiaUMkvo4NgWIX3amXfVZF5AqtFIgg9C+lNxJRgeC72EKkBAyBbK3YsWmAiFC5S77hFdWrXySRharQRaObhSQH3wXm5BGUWm2mfCxCaQI5QCpQla+zVs5zSNA6LK/iE+Ngdhp3ufXfhwQDiRO87RxivnbTPqUBuJCBYAUodqcxRAgfF1kxGcbgFI+6wOq6719qgRKCzURKO1THgiECgGlhGoMlLVwdHOBotUBXx1g6wSuDygltC6gaH3JN39GVlHM3abiQwUKrhhaBUoKWQSKVij9/ne/Png3/C/MxvtKQRn6G439xcJ4PLCVccF5QOEat7fvfAFP6OhqAuUuHE3LIJZCBTMokUJVZBDE7eM6ASWF1gUUtUGAY5JBiE/uusiKj22g8lNZc85iYrHbAzWBHJAuVg100tkQIMyHBhQNC7INVHoqa/VAuStrmwMlhBoGhPpYAcqa+EMAKjuV1QGtDkgeES35aJd5qRio5EzN5gHJQlsDFI9tzQB6hKcQDajURMSqgXTrIq8AqNxMTXtAiTH1VQJJQjSgUhMRawEkjR7fXKDEpAP7QPh5jAhUZp6dA1oRUHJWhuTjgMoDDU4IQKgQFajEREQHtFYgyrK/KwEqPs/OElBqXk8VQJiQA7IGVHienR2g9MQnyccBlQYapCX0QKFQU4DSM8OqAUJSyACo6EzN7QEqOM+uSiDiusiqhAMqBpRYvNQcqNg8OxtAytzC6oECoWYDkddFXhlQkXl2FoCUuYWVASlCZkCFJiJuFVCRaWTlgZTJl0mfegGZTyNrFlBayBSowDy7dQMNMiQ2B0idnVpnIPN5dnQgg2Gt9LGtuYNb8we8mo13LTDw1RQoAz0rg0gLRysJpMugVAqZZ5DaTld8iCHTdysFSn7dKABkOkuqJBAyfTflUx1Q5t0k8oEMJwFtI5DRFI71Aik+eiDC7TY0QCmhSoGwCeApnxoCGc1xaR6Q/m4SWiCTGQqlgLD5zasEyljqXg9kML58rUCqDwVITiHqCq9KMXn4dBkgbPqu4lMpEL7MNAmIOjp4nUCIjykQfX1OZfg0cfBrCSB0frPiUwGQbhVlEhB1bGfTgehr46lApKGLxYHQ6buqD211fzMgzQqmRCDawLPCQOjky5UBScsrpoSim6xS3AjjqpoJdJIAkiwYTLRcFWWhj6l2TENRIHRuIeZDW92/DFBk0eM86dJcICZUDVA7G4iyHmBpoMTqgRwj1Lk0XIUAvdJRGgj1CZZSWhFQJ0GRCImNAKS54FoQCPPJWGuKtni9KdAJBYgyuQwuuOZdLisEhPuIhXBWBZRYVigTSD81SFwNyr7YUQgInRgmljGhLFbGfegSKwDK6cu3C4T4VAaUWBQmE0g7b0HXE2sTqIf5UJceLwDUoQDpRp3LPbFYP5pFIJSnQiAmRAHSjBlOdDRO1W4iW0CQPfjBRF0X2RzohAiUO15P149mBagnDi4yEL5oawGgDgUoFCJ9h60CKGp6Vg6UIaTk1VqBpJaZCpS1JmmBYlRIPfByRltVDJQ4cUEf2GCgBRpYBDohAmWPlakWSOYZ8DgRvwbZQIPs9QCLFCM5hDTdvcyRDlUCxenDaeS9kIzSKynlLVZWpFgVQs9tWRfyKwSSeZC9CI2OUR97QKoQDpRxGbYyoJBnEO2yuhfc6BjjsQnEhDp6IOIdx20BBUfXQOLB90Juj7SVCxcnhTKAnlKuw9oBEjxJncy9eDSIorxEZrFMlAV0iXXlFwOSFrtF1rr1j0+V/c0BsiuRWRwfaJlAlxhREaB4ocnwQTJUmxoAnXCjTuZ3/LgvP6lUBChaqlRes7TMurErjTYhelkhbScPKFzsNnqQDKPZn8WmitbmFekZVPSlNhFI1wZtPZC82C12FnNAmnBAmnBAmnBAmnBAmnBALqJwQJpwQJpwQJpwQJpwQJpwQJpwQJowAnrzp4MD0fuBf8vPrKyvDZU+9ImbTtSmVP/2MX3TUm2obgR0+y77z+CNZfQT4ZUz7uKm1BZdc5RNx7VJ2/ZvxQ2KSJuOagebNj7E+M2iMnoa8cryXdzyIrcTM6M2adv/+81/+S7TNh3WDjZtCnTL305GXzVeOeMubul4Jf7hiJsOalO2zVBu6ZuOagebNgR6Jf65aP8Wr+J/W+QubmrwY5+aQWFLod/2twcH4iZgpE1HtYNNGzbSwT8W5WiOK+N3cUsGr/SYuGmpNmXboSGxDQpri00bAb3iutl91ZmVsbu4qdXfzekGz65N2DbsLHnTUm3YtPscpAkHpAkHpAkHpAkHpAkHpIn1Ay0OPW9njP9tfg/+MOr7/syDHy1R4C8v+uxR8KTaWDvQ4pDt+WT3Cv2jIJh02f/f74oHPLYJiO/l4sEQMokl0uLoI+/OkBXveSxnBMF8/2r55GP4MYQCVvEHP/sVq/3y3i+gUrWxdqDlRZA9o64/abG9372a7YxBLMqRxdF48d5//jBmv6GAVWQHHPx1jz3KyD1rsXYgaF4gZ3gSMQl2xLFMgfLAw4fn8/usJWI/WAErlg6xyg+zGgCxmN8dQlvNoMCJt8ojaLqD3Z/0J31/1mVNUJhVo+0BmrXg56gPieGL1ohlDCRS3AzPWi/YEXf/xXAbM4ifxYBlxBuUxWELfvF9vzsMdn/x8/0rxvZD4RG3QVsBxD8HwXmL/eZN0UP+bOKxU1WosLyANBu1xDlveQF/Wl6ws9hWACWDt0F1CgekiboB1S4ckCYckCYckCYckCb+D8i/S40uG2HIAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="hw1" class="section level2">
<h2>hw1</h2>
</div>
<div id="section" class="section level2">
<h2>1</h2>
<p>复现sample函数的功能</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(x,size,p){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  l<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,size)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size) {</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    cp<span class="ot">&lt;-</span><span class="fu">cumsum</span>(p)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    r[i]<span class="ot">&lt;-</span>x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  }</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  r</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>}</span></code></pre></div>
<p>eg1</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">3</span>,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length

## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length

## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length</code></pre>
<pre><code>## [1] 3 4 5</code></pre>
<p>eg2</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">3</span>,<span class="fu">rep</span>(<span class="fl">0.01</span>,<span class="dv">100</span>))</span></code></pre></div>
<pre><code>## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length

## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length

## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length</code></pre>
<pre><code>## [1] 81  4 50</code></pre>
<p>eg3</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="fu">c</span>(<span class="dv">99</span>,<span class="dv">2022</span>,<span class="dv">2023</span>),<span class="dv">2</span>,<span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>))</span></code></pre></div>
<pre><code>## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length

## Warning in r[i] &lt;- x[findInterval(U, cp) + 1]: number of items to replace is
## not a multiple of replacement length</code></pre>
<pre><code>## [1] 2023   99</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>2</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2} e^{-x}\)</span> , x ∈ R. Use
the inverse transform method to generate a random sample of size 1000
from this distribution. Use one of the methods shown in this chapter to
compare the generated sample to the target distribution.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20201021</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>u<span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1000</span>) <span class="co"># generate 1000 random numbers form U(0,1)</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u<span class="sc">&lt;=</span><span class="fl">0.5</span>,<span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u),<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u))))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> T)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)),<span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b/7bb/9vb////tmb/25D/27b//7b//9v///9t9KLQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJU0lEQVR4nO2deUPbNhyGRQcjZd2RlG5r2dENdxtb0mMHAeLv/7lmSb4SIr+Wrcvmff5IIU1+sh90WYctctKJiH0AqUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBvAvaXYmzW/3vef1L679/+8t1gu8WQnztLFxkQfeXz1wL2oqCpbNwYQU9IhPOBW3EybXDcFFy0PsLIU6+upF+CqSij6+E+Ow7lbl274Q4vVbminN9eyme3eQfL4vPvSjO+2Elzj9eiJPX+ftF8akmmTqACqkV3S1kkCLNMX+EGII2QpRiKkHlO/KDxUfkGV40b5/dbvV/F6ddCNJcVGo1TYCWIPnuUr68GXH8IQRVlIJkLrjNP6iKQhex4k+tvS1VFXJ+u8sqb2c3+d/Ftz6/lR9aKkFL+V3xuvy8oh2gVcSKL568XRy2C3ZEEFSczekf5f9qQWVNlOlMJX8uRGhB1R//0+8XMkDxfnG6+lUZa4fJq3JZF73iI2JklRRBkH5H1zhZWUuoP7I8ternvXPd/VgFkLkvL18bQe0A+5V0NrpFi1EH3V/qKuXX0oM+X1W63lQ/twVJo6c/f1oZBbUD7AvaLsa2aXH6Qfc/XVRVao8cpE08mAUZc5DKrKOqoHgdxd0PTY1jroPUuaqMUVfSRwQZ66CNau5GlbEIgorz/UaVM9XwyLMxt2JVDjq7vb8y10GmVky+/e9qXCGLkYPe1d0adV3Q1Q+q66DOSrrdD2oJkq38tTI+4vijFLEPsgZ6cZOX3eabsiP8vf5C8daXN49asdNfNsVbJkGtAI2grS5d2aieYqrDHdnIutUZyQnK1FhFkTvGlAuHJCeovO5ye0k+guQE5fevFuW1fhKkJygxKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQA7QdVSJuf7B7oRov1PWKzS3FQrlrYOd4v0YCqCdlfNkregy5umIuhhVS9l24YsZJWY5AXFykFKjGgIl3JuXQeVWShsHaQFrddrIV/WCQuqdyOFXWA5IUFxoCDA1ARtQy9BnZCgTIjl3Ze37QY/ANMRlMkNTCr3RGjmJyBI5Zu752qHUvCO4jQEyd7P7p88WA5q9Q61G5G0oHxT5RutqhXFUy+3sbKehKB8o5uvrXF/0VMXFDwcBYFwkxW0MbRiFBQ4HAWBcBQEwk1NEJzV8CBI+5mGIDyr4VmQ+iVdQT3GpJ+2oB6zGk9bEHMQAs9qPHFBeFbjqQsKHi4hQdVtroZF8TceVPqJL0jfg2fshKlvQfLXmEVstKO5C9KKRgzIz1yQvDXNm6K7M3xEfs6CZBOuzYyY05mxoIeVi/nkOQt6qf2MmxJ8AoJMo82W4dwgaj+xBWVNVy+tZv5Q0DraErwqBzkK54aUBKUZjoJAuNpPZEEPq2V9t/ikKulUBCUbbi6CvA13PBa0jiZIrvnZJHb/7sZPAoIy+byC8zwzD5vpZVPbkBOHCQmSczpyYVTHpYYSpOYzjKtcZy4okze57hZUqgk17ZOQoKJsPazkY1O6i9jdQgkKM3HY8pOAoIeVempDx8h98Bx0VFBgQ3ZTz/rO+49XuQ4Kh5maoLzMZh3bxeYsyMmO5jkLylzsLpixIGO1MiycC4RJUEhDe/0gh+FckJagzgZeU4+ImGuqGQvq2IBRs7tC9dSMBfUaMIPZbMaC+mHIZl7Gg4pg0xMUMpxRUNB7VLSSUs+ezNJ5ZGJqgrYn1xt5NZ/MxKFZUEhDrWZ+qa7R+009B9gOJSWkJEh2FKWgZBYvpCaoykFZKg/+7RIU0NBhHbQZ9eToWQvSXcXuVVRhtkMdbJZPRhAm0Hao1tYwk6BwhmzSCbWZJU1B+lqss4YOtR0qSUGZrpw3XQvMQuag1kbVo4KCGSqT2VaVcznvdZxA26ESFNQaxuiYmw+1HQoJEl4GD0wHo15bV2CDVrm6PeJm8e9xQeumjnKRHDgY9ersHpvhBIXaGUVB6GDUa2qCDpbXU9BBkF6CAi26rwTBCR2bcGOPKT1BaYVrLlIp6HiQfoLCTG+kKeixFQpqB+kpKMg6jwQFHVu5SUHtGL0FhTCUniBBQSCElSDvhpITtDef2kOQb0MTF+R/3MxNfHfjQfuzYViQd0N24b3Pi4kBgvwaSmxerL75eP86yPPga1rzYvo8LQRpS2uPI0M2gb3Pi4mBgnwOnaWTg47NyPcSpAwlIcjvvFhjxlaQ1+6QXWCf82LHRoF6CvLZo06lo9guWfaCPOahyIJEd83TW9DaW1MfuaMoqnMTxwd87AT56BJF7iiKdZ15RgpqmbY8BnCEFp913szvla3xgpp8ZHUU4BgtPuuso9guD51Vs62g9X5ZczK+afHZPjnIlm4DAwQdKDLiQ5C5o2jtJT5eBEV6SmZUgq03nioUBBgoaNztKKdElByUXE3cdawOYgRJNNR3fMQIkug0BDm5AcqMBeGLVQ+JBv7OmBg9LjXcJxr6O2NiRF0LOwVBzEEIPKvhIdHA3xkXw9HF6nwFPUEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIIag5tbvfdmiW2O5SOQ4MQTdPbc8WXlvmq2lIetEDMQQZDteq0cyO29LMz4REzEEbSwzvr6nkeVst20iJmIIyr4QVo9S1KXFMkvYJmIigiD5AJjiBPofvK5+7Coh60RMRGvmLTLEEEHWiZiIJqjzZmkHHx1SxGwTMRFWUOtx7RbN8KBK2jYRExFykD5fiwwxpJm3TsRElFZMnqpN/Tmko2idiIEodZB8cLJV5bCxv9SwT+Q4vFgFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBUhck15W1HlEZntQFVU95j0bqgvLtsz9futlUMIzkBeWZgx0pI0hf0NbFQrrhJC9od/Vt1FsSJi9oc/bfVcRGLHlB8q5XrnY2DSJ1QVnRxLeeZR6e1AVFh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPgqnONg91woIAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) </span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>        y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>    } </span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>}</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>xx <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>yy <span class="ot">=</span> <span class="dv">12</span><span class="sc">*</span>xx<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>xx)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="fu">lines</span>(xx, yy)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ2/+2ZgC2Zjq2ZpC2kGa229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///+CWcFlAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIsklEQVR4nO2da2ObNhiFSZcsntduTZpurbut2+Juy0ovi5OY///LpgvYgBFHQgJk+TwfWnPRC3osCQkTkRWkl2zuE4gdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCDC6oO0qu7jX/1/uFmqb//o39AE/LLLsx2DhZhb0ePMstKBNJrgKFm5aQQess+CC8uzsNmC4WUrQp2WWnf1wJ/0IpKIvr7Psm59U4dp+yLLzW2VO5PX9TfbsrvhyI/Z7LvL9dJ1dfllmZ2+KTwux1/4wuwAqpFJUfSWiSL0dfv5zCMqzrBRTCSrXyB3FLjKHy/3qi/uN3iyyLQRplpVazT7AXpBYqXbwK6VTCKooBclScF98Vg2FPvmHRentSn3fl/fbdeXt4q74T6T69l7udKUEXcm02Ztyf0U9wL6KibVvdaHzOP8ZBInzPv+n3KoFrWtftf4scqUFVZXj699LGUCsFyb0v8pYPUxR1cvb3aEvfWvYHIL0Gt3iqCxVtVBmrfrcyOv2lyqALg76372geoB6I51r462ehRtztEGPN7pJ+aP0UFUC+V1Xn+uCpNHz375eGwXVA9QFyTomtnld8+fpBz3+uqyaVIsSpE08mQWZSpA8pu9Vf7aO4vbdvsUxt0Eqc7oVqRrpDkGGNkgZW/rVsDkEify+VPVMXXhkbsxXsaoEXdw/rsxtkOEqptb79qrnKEEfdt0aNS7o6wft2qDeRrreD2oIkik9u+qzVLHPsgV6fleU3ea7siP8s04gVr24O7iKnf8ur0kmQbUAjUZHlke/84/1dofnxbnCsxNURChore5ViNLh+c0rREPnOxiOTlA57goxJFcDN98bH9EJKh5fL8qxvi9C0NlL3yDxCYoMCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEGBqQVMdL9hxJhY02eEoaKojUdBEcUIeLmsz2pEmjBPyaNnHJhTU3iuEoFA5m1SQ5cEoCO1GQa3VbdITZHfBMW08EBJEUKisBYliF46CKMgrnHHbSILC5I2CpghiF46CQLjJBQXJ3HSCzJsoCGwaTVCI3FHQ+CEsw1FQf7g+dW6CHO6nnYqgwWPZUxE0vAb6Z28qQb25oCAKguEoCISbSZB//iYS1J8JCkpBkOdkce1wluv1xhEFeRuqpc9HnOkiCUFFAEepC9KKzDPKVHNBGfcw/fLVfw5HI0hOTfNWWDDNbZRXxWtjKmd2gtDgKk5BcrYdbWZjKCDb1X7OMINDS0FOQvwE+RqqXcXglEZP17vprkwOu8+mvfY4Bb3SfkxZLzxKUFKC8p5Jv/JqxjTHNigBQet9i9l3ma+mczbOUBehIE9DByXIj4QFhaEz3MHKExBkaqlmEQRu4ocQ9HR9tZstfsjMjP2/MIwtqL0Mj++UNZ/EluEoCIRLRJCoZuo1BMGnpz5cd5yC1vJ9BZfF2uu2WcKC5EBrI3rKPUONXTtubsqjFORlqCFoLSe57rmKbVfoEtdxKl2rjlGQqFtP1/K1KX1VbLsCFTBlQXJy4VtkYAMm+E5ZUBDsTm5qQT65pCDrHMEb8m7hzGuOVdA6xLviEhYkO9L+2HXSJhfkYajRD/InYUGwi+MWrrEC/MXccQiCXRzHcPUVvjn2FzTcUK2KedwwM59HOoLC0H27k4KM4ZISpN49uQ77urJoBA02VGukz25zOZoP+nzQLII6f+TwFiR/eJe/uPfdD3II11ieWFBrsfvMnHMkO4pSUM8dRZdwjcUkBFUlaB3yta0pCSrboNyvuxivoKGGmlcx7xfDZZ1LiQgKAQU5hUtKkB6L+b67M11Ba90450Ff/BuVoIGGylSbqnF+WIS7iu1P7egF1e6WDfptvvv5oIQE1UZgAYcaSQmCj4i7hGsvxCFomCEKssoRBYEcjSKodmYJCIKPRrmEa38+fkHBiFrQoMxSkEOOAtB9NhTUFS4aQeAvFexzFIIYBbU+UlDP7hkFHYcg8LgLBWUd50VBxyBILlAQBSUhqH1aFERBFGSB5fxB8QoSS2MKsp0/KDs4q9MQZD37y6kKsp4/6FQFsQQhbOcPcvxjjCkFfRz3hpnl/EGnK8gyHAVREKJ//qBJc+y8+ySC2lGaPxkc3FGMijkEJQwFAQIPVtMj8GA1PQIPNcqgUTOeIOvHrFBQsN1vs29yj93tS5DfQY9WkMVg1S5osoLwYNUuaLqCAgWlIL/tFERBftsp6OQFpQQFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoChBS0qU9gtXGezaqdwnE2tUZy+bLPELMbBxUkZ5DZzSLTWHBPLpfdJjNqJM/lQhhD4QTpH4XKyWMaC+7Ji3Je0MFHv3Q8uplwgvTMQ+WDQ40F9+Ty08U7F0GN5JEK+k6W7/In18aCe3K16NQGNZNHWcV0A1A2A40F9+SqxjgJah3Q/RJhIlJBznOCNpPLNzw8LII8gRJnFVMLw6uYewtoJs5GOi+fVLFvRRrJ3cuvmWgv844lqJFc2/KbCaki3o6iY0+6kTzKNkhVDHmGuheSO19HGskL56FGI7l8NXOYpwQ5WAVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQFiF6QeicqDPNA7jNgFycfEtqswf1UwiNgFyVmv9AOaMxG7IFnH+qe7GpnoBYk6tp5zyr3oBT29+vPVjDUsfkHb1fdz1rD4BXm/4d2T+AXNeg07CkEv5qxhRyAon3fa2NgFPSxmbaLjFzQ7FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwP0Vzme2yeRC2AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="section-3" class="section level2">
<h2>4</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function
<span class="math inline">\(f_{e} (x)=\frac{3}{4} (1-x^{2})\)</span>
Devroye and Gy¨orfi [71, p. 236] give the following algorithm for
simulation from this distribution. Generate iid U1, U2, U3 ∼ Uniform(−1,
1). If |U3| ≥ |U2| and |U3|≥|U1|, deliver U2; otherwise deliver U3.
Write a function to generate random variates from fe, and construct the
histogram density estimate of a large simulated random sample.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>u1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>u2<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>u3<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="cf">if</span> ((<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2))<span class="sc">&amp;</span>(<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u1)))</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  u[i]<span class="ot">&lt;-</span>u2 <span class="cf">else</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    u[i]<span class="ot">&lt;-</span>u3</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="fu">hist</span>(u)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////+30rdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIEklEQVR4nO2daXujNhhFyTRp3LrTae1m2k7cTpeQLm49k6lxbP7/D6sWsAFHXBAChHzPhywgXqPzCC0g5CgltURjn4DvUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYC+BR1W0c1W/749/lPY/cc/rj/wcRZF37iLN66g57tXrgUlkWDhLt6ggs6II+eCNtHVg8t4Y5SgD/Mounqzln4EUtHT2yj67HtVuA6PUXT9oMyJvP56F71ap093It1rke/9Mrp9mkdX79IPM5Hq9DHHACpkpkjrF8d0KVAjCNpEUSYmF5RtkQlFEpnD+WnzzTbRu0W2RWY181yt5hRgioJyMkGyFGzTj6qi0FnYzTJvC1WF3G4Pce7tZp3+J476fCsTLZSghTw2epelVxQDFC6xiQoSubn+O9urs5DVRLEuVFmmtKD7LOGnP+cygNguTOifylgxTJpflxMXpLfoGkdlIb8KZdbyv0t5PfycB5ClL81+ngQVA0xRULUOer7TVcrvWRZ0ftXVdZ//XRQkjV7/8mlpFFQMcC6oUNJsGKUf9Px+nlepDUqQzuHeLKi+BE1RkPz/p1ONY66DVF5VwThW0i8IMtVB+s+kW79xeEHihL9V15lqeGQWzK1YXoJuts8rcx1kasXUBnngtASlj8dujRoX1PWDjnVQbSVd7AcVBYkUmokJSj/KGuj1Os26zeusI/yDPkBs+np91opd/7YRm0yCCgGKQ42daA7e/OV3K2ZJXB32j4ZvgmJ1r0KUjheGtqPgm6Bs3OV4SN4B3wSlz29n2VjfD7wT5BsUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCgnaB8ooXz2c3+0krQJp8nkbicy+43bQQdVqcJOb5MvuidNoL2y3xWbppczEXGEgRoWQdlRYh1kIH8XYmLKT+T7AdFVfr9tF6j90L0bxl/BO2XsuZJxu4oei5ItV+FBn94/BaUqRmzmfdb0G6mBFU6igNVmNmHeS0IlKBLF6TfmMir647hbPFXUKocXT3UdKSdnCzo6HgtaJBwwAAFURAKUjVQgYKqBmr/9UjQcd0D82DjsgWlhxUahAUsKH/5vJbDCqQJWJB+MxbdKEyi+lFq0ILSZo5ahGt6EGqm/BGkFXW422MnqF6IR4LkvbB7UdHY38sIWZBsxLWZDg+9Aha0X7p40ThgQSOGm4qgWFxgXZ8IhiwoVhXQftlpyYOABeUPKrpNSxhFUK8PEo/R8pkJm+kJ6rVEnaLpmQm72Qg96WkI0usRdWzrgxY0WjgKQgdNQ5CTGawhC4pdTNkIWJDxYalduFYHTUSQixktAQuCt5vbhWt10CQEwdvNLcPVpmp1i9UTQceHXgO0Ym1z7IWgblHaDRQvT1DLcBMVpFZCj4e4YTZNQcnVw0YuyT/AaH6SguT9IDnzcIj7QZMUJDuKUtAQdxQnKSgvQXGnGdABC8rqoE237mLIgnRXcZA7ihMVNFw4CkKppiiIY7FmOer4OvPLJwdmSE1KUBr38Oi5a469EtRHRzEoQX0MNQYW5PRRffXwXmZ3DCyo8m+X/LzQinV71zJgQW6gIKtwQQhq8KZKm3DlrSEIyh779DKaD0LQYaXNdHsjPmBB++/0jY4AOor9CMpLUB93FIMQJO8oip+b2jtmcA5RyIJ0O1ZbfvAqeEELgjRYw+yyBTVYBS9oQfDR84WXoAaPnvEqeAELavToGQ75AxbU56PnIAR1evQMbt8FIajBo+cGq+CFLAg/em6wCl7QgiDWa5gFIajQyTFhXgXvPFx5awiCGsy0v+wS1KB9t14FLwhBzSYv2K2CF4QgN1CQVbjpC3K2um/Qgho09A3DnW2loHK4s60UVA53tpWCyuHOtlJQOdzZVgoqhzvbOqqgbjPOckEupnZ4Kqi620WOrKGgRuHAvGgKGjjHFERBFERBFERBFERBFDS6oIaTOC9WUNNJnJcqqPEUvEsVZJ7EWbnZcjZY9Yr+BPGrjBH8KmMEv8qYVOlF0LiVMMIHQW7TjZLMMrnboBTkJh0F+ZjMMrnboBTkJh0F+ZjMMrnboBTkJl14gkKCggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAVwL2n15fGifdPwKgdLx5mDFPaf3sp2dmmNB++VxVoNcNC7pYKh0vDlYac/uC/PnWZ6aW0HJaW6Vnulgv7556XhzsPKemnf/bU/NqaAkWhxPUa9hYb98d+l4c7Dyno0x09an5roOOp2FKu32yzWVjjcHK++JvxJVkGniid2p9SZIX+P2lVDpeHOw0p79Uk47Ma1TZ3dqQQmqnIKTUwvrEtObZi+vkjDqJbbJr/1xK2m9ydDWe1ZJj9HM65zDS2y8Zr54FqN0FFWmYSU9YkcxOwv9tcibjkON7HgUrJQsFpe6aZ0Wu1PjYBVAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFATwXZBaec/ZVw9ZQEEACgJQEICCABQE8F/Qwjw1fAh8F3RY3WwPq5ovoO4b3wWplwh/5CXmLxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/eOkOzYw/cwgAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-4" class="section level2">
<h2>5</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density <span class="math inline">\(f_{e}\)</span></p>
<p>pf: <span class="math inline">\(p f:\)</span> 假设生成的随机变量为
<span class="math inline">\(X\)</span>, 则 <span class="math inline">\(P(X&lt;=x)=P\left(X&lt;=x|| U_3\right.\)</span>
|最大 <span class="math inline">\()
P\left(\left|U_3\right|\right.\)</span> 最大 <span class="math inline">\()+P\left(X&lt;=x|| U_3 \mid\right.\)</span>
不是最大 <span class="math inline">\()
P\left(\left|U_3\right|\right.\)</span> 不是最大 <span class="math inline">\()\)</span> 由独立性可知 <span class="math inline">\(P\left(\left|U_3\right|\right.\)</span> 最大 <span class="math inline">\()=\frac{1}{3},
P\left(\left|U_3\right|\right.\)</span> 不是最大 <span class="math inline">\()=\frac{2}{3}\)</span> <span class="math display">\[
\begin{aligned}
&amp; P\left(X&lt;=x|| U_3 \mid \text { 最大 }\right)=3 P\left(U_2 \leq
x,\left|U_3\right| \geq\left|U_2\right|,\left|U_3\right|
\geq\left|U_1\right|\right) \\
&amp; \text { 若 } x \geq 0, \\
&amp; \text { 上式 }=3\left(\int_{-1}^{-x} \int_{u_3}^x
\int_{u_3}^{-u_3}+\int_{-x}^0 \int_{u_3}^{-u_3}
\int_{u_3}^{-u_3}+\int_0^x \int_{-u_3}^{u_3} \int_{-u_3}^{u_3}+\int_x^1
\int_{-u_3}^x \int_{-u_3}^{u_3}\right) \frac{1}{8} d u_1 d u_2 d u_3 \\
&amp; =\frac{1}{2}+\frac{3}{4} x-\frac{1}{4} x^3
\end{aligned}
\]</span> 若 <span class="math inline">\(x&lt;0\)</span>, <span class="math display">\[
\begin{aligned}
&amp; \text { 上式 }=3\left(\int_{-1}^x \int_{u_3}^x
\int_{u_3}^{-u_3}+\int_{-x}^1 \int_{-u_3}^x \int_{-u_3}^{u_3}\right)
\frac{1}{8} d u_1 d u_2 d u_3 \\
&amp; =\frac{1}{2}+\frac{3}{4} x-\frac{1}{4} x^3
\end{aligned}
\]</span> 综上, <span class="math inline">\(P\left(X&lt;=x|| U_3
\mid\right.\)</span> 最大 <span class="math inline">\()=\frac{1}{2}+\frac{3}{4} x-\frac{1}{4}
x^3\)</span> <span class="math display">\[
P\left(X&lt;=x|| U_3 \mid \text { 不是最大 }\right)=\frac{3}{2}
P\left(U_3 \leq x,\left|U_3\right|&lt;\left|U_1\right| \text { 或
}\left|U_3\right|&lt;\left|U_2\right|\right)
\]</span> 上式 <span class="math inline">\(=3 P\left(U_3 \leq
x,\left|U_3\right|&lt;\left|U_1\right|,\left|U_1\right|&lt;\left|U_2\right|\right)\)</span>,
<span class="math inline">\(P\left(X&lt;=x|| U_3 \mid\right.\)</span>
不是最大 <span class="math inline">\()=\frac{1}{2}+\frac{3}{4}
x-\frac{1}{4} x^3\)</span> 所以, <span class="math inline">\(P(X&lt;=x)=\frac{1}{3}\left(\frac{1}{2}+\frac{3}{4}
x-\frac{1}{4} x^3\right)+\frac{2}{3}\left(\frac{1}{2}+\frac{3}{4}
x-\frac{1}{4} x^3\right)=\frac{1}{2}+\frac{3}{4} x-\frac{1}{4}
x^3\)</span> <span class="math inline">\(f_X(x)=\frac{3}{4}\left(1-x^2\right)\)</span>.</p>
</div>
<div id="hw2" class="section level2">
<h2>hw2</h2>
</div>
<div id="section-5" class="section level2">
<h2>1</h2>
<p>Proof that what value <span class="math inline">\(ρ
=\frac{l}{d}\)</span> should take to minimize the asymptotic variance of
<span class="math inline">\(\hat{\pi }\)</span>? (m ∼ B(n, p)</p>
<p><span class="math inline">\(pf:\)</span> <span class="math display">\[
\begin{aligned}
&amp; 由于m服从参数为n和p的二项分布，所以\sqrt{n} (\frac{m}{n} -p)
\sim  N(0,p(1-p))，且\hat{\pi }=\frac{2\rho n}{m}=\frac{2\rho
}{\frac{m}{n} } ，均值为\frac{2\rho}{p}，\frac{\partial \frac{2\rho }{p}
}{\partial p } =\frac{-2\rho }{p^{2} }，\\
&amp; 根据δ定理，\hat{\pi
}服从均值为\frac{2\rho}{p}，方差为\frac{4p(1-p)\rho ^{2}}{p^{4}
}  =\frac{4(1-p)\rho
^{2}}{p^{3}}的正态分布，而p=\frac{2l}{d\pi}=\frac{2\rho}{\pi}，\\
&amp; 所以方差可以写成\frac{4(1-p)(\frac{\pi p }{2} )^{2}
}{p^{3}}=\frac{ 4(1-p)\pi
^{2}}{p}，所以当p越大，方差越小，而p=\frac{2l}{d\pi } =\frac{2\rho }{\pi
}，\rho&lt;=1，所以当\rho取1时，方差最小。
\end{aligned}
\]</span></p>
</div>
<div id="section-6" class="section level2">
<h2>2</h2>
<p>Take three different values of ρ (0 ≤ ρ ≤ 1, including $_{min} $) and
use Monte Carlo simulation to verify your answer. (n = <span class="math inline">\(10^{6}\)</span>, Number of repeated simulations K
= 100)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>    pihat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>    pihat</span></code></pre></div>
<pre><code>## [1] 3.140679</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    </span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    pihat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    pihat</span></code></pre></div>
<pre><code>## [1] 4.77677</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    pihat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    pihat</span></code></pre></div>
<pre><code>## [1] 3.56717</code></pre>
</div>
<div id="section-7" class="section level2">
<h2>3</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of $=_{0}^{1} e^{x}dx $ Now consider the antithetic
variate approach. Compute Cov(<span class="math inline">\(e^{U}\)</span>
, <span class="math inline">\(e^{1-U}\)</span> and Var(<span class="math inline">\(e^{U}\)</span> +<span class="math inline">\(e^{1-U}\)</span> ), where U ∼ Uniform(0,1). What
is the percent reduction in variance of <span class="math inline">\(\hat{\theta }\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><span class="math inline">\(sol:\)</span> <span class="math display">\[
\begin{aligned}
&amp;  Cov(e^{U},e^{1-U})=E(e^{U}e^{1-U})-E(e^{U})E(e^{1-U})=e-(e-1)^{2}
；\\
&amp; Var(e^{U})=E(e^{2U})-(E(e^{U}))^{2}=\frac
{1}{2}(e^{2}-1)-(e-1)^{2}；\\
&amp;
Cor(e^{U},e^{1-U})=\frac{Cor(e^{U},e^{1-U})}{\sqrt{Var(e^{U})}\sqrt{Var(e^{1-U})}
}=\frac {e-(e-1)^{2}}{\frac {1}{2}(e^{2}-1)-(e-1)^{2}}; \\
&amp;
当不运用对偶变量法时，Var(\frac{1}{2}(e^{U}+e^{V}))=\frac{1}{4}(2\times(\frac
{1}{2}(e^{2}-1)-(e-1)^{2}))≈0.1210\\
&amp;
当运用对偶变量法减小方差时，Var(\frac{1}{2}(e^{U}+e^{1-U}))=\frac{1}{4}(2\times(\frac
{1}{2}(e^{2}-1)-(e-1)^{2})+2\times (e-(e-1)^{2}))≈0.003912 \\
&amp; 方差减小的百分比为\frac{0.1210-0.003912}{0.1210}=96.8\%
\end{aligned}
\]</span></p>
</div>
<div id="section-8" class="section level2">
<h2>4</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>mc<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{<span class="fu">mean</span>(<span class="fu">exp</span>(<span class="fu">runif</span>(<span class="dv">10000</span>)))})</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>anti<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">5000</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(u)<span class="sc">+</span><span class="fu">exp</span>(v))<span class="sc">/</span><span class="dv">2</span>})</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>v1<span class="ot">&lt;-</span><span class="fu">var</span>(mc)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>v2<span class="ot">&lt;-</span><span class="fu">var</span>(anti)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>(v1<span class="sc">-</span>v2)<span class="sc">/</span>v1</span></code></pre></div>
<pre><code>## [1] 0.9703766</code></pre>
</div>
<div id="hw3" class="section level2">
<h2>hw3</h2>
</div>
<div id="补充题" class="section level2">
<h2>补充题：</h2>
<p><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^M\right)=\frac{1}{M
k} \sum_{i=1}^k
\sigma_i^2+\operatorname{Var}\left(\theta_I\right)=\operatorname{Var}\left(\hat{\theta}^S\right)+\operatorname{Var}\left(\theta_I\right)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U) \mid I=i],
\sigma_i^2=\operatorname{Var}[g(U) \mid I=i]\)</span> and <span class="math inline">\(I\)</span> takes uniform distribution over <span class="math inline">\(\{1, \ldots, k\}\)</span>.</p>
<p>Proof that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a, b)\)</span>, then <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^S\right) /
\operatorname{Var}\left(\hat{\theta}^M\right) \rightarrow 0\)</span> as
<span class="math inline">\(b_i-a_i \rightarrow 0\)</span> for all <span class="math inline">\(i=1, \ldots, k\)</span>.</p>
<p><span class="math inline">\(pf:\)</span> <span class="math display">\[
\begin{aligned}
&amp;
由于\hat{\theta}^M的估计与区间长度无关，故只需要证明\hat{\theta}^S在b_i-a_i
\rightarrow 0时趋于0即可.\\
&amp;
而\operatorname{Var}\left(\hat{\theta}^S\right)=\operatorname{Var}\left(\frac{1}{k}
\sum_{j=1}^k \hat{\theta}_j\right)=\frac{1}{k^2} \sum_{j=1}^k
\frac{\sigma_j^2}{m}=\frac{1}{M k} \sum_{j=1}^k \sigma_j^2,\\
&amp; 当b_i-a_i\rightarrow
0时,k趋于无穷,所以M也趋于无穷,所以Mk也趋于无穷,下面证明\sigma_j^2是有限的.\\
&amp; \sigma _{i} ^2=var[g(u)|I=i]=E(g(u)^2|I=i)) -(E(g(u)|I=i))^2，\\
&amp;
而E(g(u)|I=i)=\int_{a_i}^{b_i}  g(u)\frac{1}{b_i-a_i}du=\frac{g(\theta)}{b_i-a_i}(b_i-a_i)=g(\theta)(a_i&lt;\theta&lt;b_i)有限,\\
&amp; 所以E(g(u)|I=i)有限,\\
&amp; 同理E(g(U)^2|I=i)有限,所以\sigma_i^2有限,\\
&amp; 而g是连续函数，所以g在[a,b]上有最大值，记为g_{max},\\
&amp; 所以\sigma_1^2,\sigma_2^2,\dots,\sigma_k^2也有上界g_{max},\\
&amp; 所以\operatorname{Var}\left(\hat{\theta}^S\right)=\frac{1}{M k}
\sum_{j=1}^k
\sigma_j^2\le\frac{kg_{max}}{Mk}=\frac{g_{max}}{M}\rightarrow 0,\\
&amp; 所以\hat{\theta}^S在b_i-a_i \rightarrow 0时趋于0.
\end{aligned}\\
\]</span></p>
</div>
<div id="section-9" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1 .
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
<p>sol:我们选择均值为1的正态分布和<span class="math inline">\(\alpha\)</span>为<span class="math inline">\(\frac{3}{2}\)</span>和<span class="math inline">\(\beta\)</span>为2的伽马分布。下面是三个分布的分布函数曲线。</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dgamma</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
下面画<span class="math inline">\(\frac{f(x)}{g(x)}\)</span>的函数曲线。</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">plot</span>(x, y<span class="sc">/</span>(<span class="fu">dgamma</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">lines</span>(x, y<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">dnorm</span>(x, <span class="dv">1</span>)), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>),<span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>由图像可以看出，函数f1的更加平稳，故选择正态分布函数做重要函数得到的方差更小。</p>
</div>
<div id="section-10" class="section level2">
<h2>5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling.</p>
<p>sol:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">rchisq</span>(m,<span class="dv">1</span>))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="dv">1</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>g<span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>})</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>data2<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(m, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">dgamma</span>(x <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>g<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>})</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(data1),<span class="fu">mean</span>(data2))</span></code></pre></div>
<pre><code>## [1] 0.4006576 0.4005876</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(data1),<span class="fu">var</span>(data2))</span></code></pre></div>
<pre><code>## [1] 1.999179e-07 1.169096e-06</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">var</span>(data1)<span class="sc">/</span><span class="fu">var</span>(data2)</span></code></pre></div>
<pre><code>## [1] 0.1710022</code></pre>
<p>所以选择正态分布函数作为重要函数方差更小。</p>
</div>
<div id="section-11" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span>; k <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k </span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> </span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M)))</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)T2[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M<span class="sc">/</span>k,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k)))</span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(T2)</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>}</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,mean),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0995 0.0994</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,sd),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 7e-04 1e-04</code></pre>
</div>
<div id="section-12" class="section level2">
<h2>6.5</h2>
<p>Suppose a <span class="math inline">\(95 \%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean,
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95 .
Use a Monte Carlo experiment to estimate the coverage probability of the
<span class="math inline">\(t\)</span>-interval for random samples of
<span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation
results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>t0<span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>cl<span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)})</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>lcl<span class="ot">&lt;-</span>cl[<span class="dv">1</span>,]</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>ucl<span class="ot">&lt;-</span>cl[<span class="dv">2</span>,]</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="fu">mean</span>(lcl<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> ucl<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<p>计算得出t区间更稳健。</p>
</div>
<div id="hw4" class="section level2">
<h2>hw4</h2>
</div>
<div id="section-13" class="section level2">
<h2>1</h2>
<p>总体服从指数分布<span class="math inline">\(exp(\lambda)\)</span>,<span class="math inline">\(\lambda\)</span>的MLE即<span class="math inline">\(\hat{\lambda}=\frac{1}{\overline{X}}\)</span>,理论偏差和标准差分别为<span class="math inline">\(\lambda /(n-1)\)</span>,<span class="math inline">\(n\lambda/[(n-1)\sqrt{n-2}]\)</span>.用Bootstrap方法进行模拟.</p>
<div id="n5" class="section level3">
<h3>n=5</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>    n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">2</span>) </span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fl">1e3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x); </span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>      thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>      </span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    }</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">mean</span>(thetastar)<span class="sc">-</span>lambda,<span class="fu">sd</span>(thetastar))</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>    })</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 4.835908</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 15.2339</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>  n<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)</span></code></pre></div>
<pre><code>## [1] 1.443376</code></pre>
</div>
<div id="n10" class="section level3">
<h3>n=10</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>    n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">2</span>) </span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fl">1e3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x); </span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>      thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>      </span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>    }</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">mean</span>(thetastar)<span class="sc">-</span>lambda,<span class="fu">sd</span>(thetastar))</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>    })</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.310308</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.2222222</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 1.015529</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>  n<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)</span></code></pre></div>
<pre><code>## [1] 0.7856742</code></pre>
</div>
<div id="n20" class="section level3">
<h3>n=20</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>    n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">2</span>) </span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fl">1e3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>);thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x); </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>      thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>      </span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>    }</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">mean</span>(thetastar)<span class="sc">-</span>lambda,<span class="fu">sd</span>(thetastar))</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    })</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.04295529</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1052632</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>  <span class="fu">mean</span>(a[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.3137746</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>  n<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)</span></code></pre></div>
<pre><code>## [1] 0.4962153</code></pre>
<p>根据结果可以得到，随着n的增加，bootstrap的均值偏差和标准差越来越接近实际均值偏差和标准差</p>
</div>
</div>
<div id="section-14" class="section level2">
<h2>2</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>cor.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) { <span class="fu">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])}</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>cor.stat2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">boot</span>(x[i, ], cor.stat, <span class="at">R =</span> <span class="dv">25</span>)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(i)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a><span class="fu">c</span>(o<span class="sc">$</span>t0, <span class="fu">var</span>(o<span class="sc">$</span>t) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>}</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a><span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = &quot;stud&quot;)
## 
## Intervals : 
## Level    Studentized     
## 95%   (-0.3964,  1.0086 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="section-15" class="section level2">
<h2>3</h2>
<p>考虑m=1000个假设,其中前95%为原假设成立,后5%对立假设成立.原假设下p值服从U(0,1),对立假设下为Beta(0.1,1),
分别用Bonferroni和B-H矫正p值,在0.1的显著性水平下进行10000次模拟</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>FWER.bonf <span class="ot">&lt;-</span> FDR.bonf <span class="ot">&lt;-</span> TPR.bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>FWER.bh <span class="ot">&lt;-</span> FDR.bh <span class="ot">&lt;-</span> TPR.bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>  p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>  p[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">50</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>  p.bonf <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>  p.bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>  FWER.bonf[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(p.bonf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>  FDR.bonf[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.bonf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(p.bonf <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>  TPR.bonf[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.bonf[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>  FWER.bh[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(p.bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>  FDR.bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(p.bh <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>  TPR.bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.bh[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="sc">&lt;</span> <span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>}</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(FWER.bonf),<span class="fu">mean</span>(FWER.bh))</span></code></pre></div>
<pre><code>## [1] 0.0960 0.9305</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(FDR.bonf),<span class="fu">mean</span>(FDR.bh))</span></code></pre></div>
<pre><code>## [1] 0.004865608 0.095356031</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(TPR.bonf),<span class="fu">mean</span>(TPR.bh))</span></code></pre></div>
<pre><code>## [1] 0.399026 0.562730</code></pre>
<p>Bonf的FWER接近0.1,B-H的FWER大于0.1;Bonf的FWER小于0.1,B-H的FDR接近0.1;TPR中B-H大于Bonf。</p>
</div>
<div id="hw5" class="section level2">
<h2>hw5</h2>
</div>
<div id="section-16" class="section level2">
<h2>1</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile,and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a> <span class="fu">library</span>(boot)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a> x <span class="ot">&lt;-</span> aircondit[<span class="dv">1</span>]</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a> meant <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ])))</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a> b <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> meant, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a> b</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = meant, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833 -0.4005    37.57589</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a> <span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.8, 182.1 )   ( 26.4, 169.0 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.2, 189.8 )   ( 57.5, 227.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a> <span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a> <span class="fu">hist</span>(b<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a> <span class="fu">points</span>(b<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-17" class="section level2">
<h2>2</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta }\)</span>
.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a> <span class="fu">library</span>(bootstrap)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a> <span class="fu">attach</span>(scor)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(scor)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a> theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a> lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a> theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a> y <span class="ot">&lt;-</span> x[<span class="sc">-</span>i, ]</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a> s <span class="ot">&lt;-</span> <span class="fu">cov</span>(y)</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a> lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(s)<span class="sc">$</span>values</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a> theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a> }</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a> bias.jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a> se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a> <span class="fu">c</span>(theta.hat, bias.jack, se.jack)</span></code></pre></div>
<pre><code>## [1] 0.619115038 0.001069139 0.049552307</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a> <span class="fu">list</span>(<span class="at">est =</span> theta.hat, <span class="at">bias =</span> bias.jack, <span class="at">se =</span> se.jack)</span></code></pre></div>
<pre><code>## $est
## [1] 0.619115
## 
## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<p>用jackknife法得出的偏差估计和标准差估计与用bootsrtap方法得出的估计没有很大差距。</p>
</div>
<div id="section-18" class="section level2">
<h2>3</h2>
<p>Leave-one-out (n-fold) cross validation was used to select the best
fitting model for the ironslag data. Use leave-two-out cross validation
to compare the models.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a> <span class="fu">library</span>(DAAG, <span class="at">warn.conflict =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a> <span class="fu">attach</span>(ironslag)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a> e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> e5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a> ij <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a> y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a> x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a> J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a> yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a> e1[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a> J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a> yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a> e2[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a> J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a> logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a> yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a> e3[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a> J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a> logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a> yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a> e4[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a> c2 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a> c3 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb87-28"><a href="#cb87-28" tabindex="-1"></a> J5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> c2 <span class="sc">+</span> c3)</span>
<span id="cb87-29"><a href="#cb87-29" tabindex="-1"></a> yhat5 <span class="ot">&lt;-</span> J5<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J5<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb87-30"><a href="#cb87-30" tabindex="-1"></a> J5<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J5<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb87-31"><a href="#cb87-31" tabindex="-1"></a> e5[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat5)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-32"><a href="#cb87-32" tabindex="-1"></a> ij <span class="ot">&lt;-</span> ij <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb87-33"><a href="#cb87-33" tabindex="-1"></a> }</span>
<span id="cb87-34"><a href="#cb87-34" tabindex="-1"></a> <span class="fu">c</span>(<span class="fu">sum</span>(e1), <span class="fu">sum</span>(e2), <span class="fu">sum</span>(e3), <span class="fu">sum</span>(e4), <span class="fu">sum</span>(e5))<span class="sc">/</span>N</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436 36.46996</code></pre>
<p>通过leave-two-out交叉验证，依然选择quadratic模型.</p>
</div>
<div id="hw6" class="section level2">
<h2>hw6</h2>
</div>
<div id="section-19" class="section level2">
<h2>1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p><span class="math inline">\(pf:\)</span> <span class="math display">\[
\begin{aligned}
&amp; K(s,r)f(s)=[I(r \ne
s)\alpha(s,r)g(r|s)+I(r=s)(1-\int\alpha(s,r)g(r|s))]\times f(s)\\
&amp;             =[I(r \ne
s)min(\frac{f(r)g(s|r)}{f(s)},g(r|s))+I(r=s)(1-\int\alpha(s,s)
g(s|s))]\times f(s)\\
&amp;=I(r\ne s)min(f(r)g(s|r),f(s)g(r|s))+I(r=s)(1-\int\alpha(s,s)
g(s|s)) f(s)\\
&amp;=[I(r \ne
s)min(\frac{f(s)g(r|s)}{f(r)},g(s|r))+I(r=s)(1-\int\alpha(s,s)
g(s|s))]\times f(r)\\
&amp;=[I(r \ne
s)\alpha(r,s)g(s|r)+I(r=s)(1-\int\alpha(r,s)g(s|r))]\times f(r)\\
&amp;=K(r,s)f(r)
\end{aligned}
\]</span></p>
</div>
<div id="section-20" class="section level2">
<h2>2</h2>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a> cvm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">199</span>) {</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a> z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a> Fn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a> Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a> Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x))</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a> Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> y))</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a> }</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a> cvm0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a> cvm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a> Z <span class="ot">&lt;-</span> z[k]</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a> X <span class="ot">&lt;-</span> Z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a> Y <span class="ot">&lt;-</span> Z[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a> Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> X))</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a> Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> Y))</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a> }</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a> })</span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a> cvm1 <span class="ot">&lt;-</span> <span class="fu">c</span>(cvm, cvm0)</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> cvm0, <span class="at">p.value =</span> <span class="fu">mean</span>(cvm1 <span class="sc">&gt;=</span></span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a> cvm0)))</span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a> }</span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a> <span class="fu">attach</span>(chickwts)</span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a> x1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a> x2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a> <span class="fu">detach</span>(chickwts)</span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a> a<span class="ot">&lt;-</span><span class="fu">cvm.test</span>(x1,x3)</span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a> a[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## $p.value
## [1] 0.395</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a> b<span class="ot">&lt;-</span><span class="fu">cvm.test</span>(x2,x3)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a> b[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## $p.value
## [1] 0.005</code></pre>
<p>经过检验,soubean和linseed
supplements之间没有显著性差异，但是sunflower和linseed
supplements之间有显著性差异。</p>
</div>
<div id="section-21" class="section level2">
<h2>3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a> test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>}</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">199</span>) {</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> k[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> k[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a><span class="fu">test</span>(z[k1], z[k2])</span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>})</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">test</span>(x, y)</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a>stats1 <span class="ot">&lt;-</span> <span class="fu">c</span>(stats, stat)</span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(stats1)<span class="sc">/</span>(R <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> stat, <span class="at">p =</span> <span class="fu">mean</span>(stats1 <span class="sc">&gt;=</span></span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a>stat), <span class="at">freq =</span> tab, <span class="at">cdf =</span> <span class="fu">cumsum</span>(tab)))</span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a>}</span>
<span id="cb93-24"><a href="#cb93-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb93-25"><a href="#cb93-25" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb93-26"><a href="#cb93-26" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb93-27"><a href="#cb93-27" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb93-28"><a href="#cb93-28" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb93-29"><a href="#cb93-29" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb93-30"><a href="#cb93-30" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb93-31"><a href="#cb93-31" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">out</span>(x, y)</span>
<span id="cb93-32"><a href="#cb93-32" tabindex="-1"></a>a[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## $estimate
## [1] 4</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>a[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## $p
## [1] 0.48</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>a[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## $freq
## stats1
##     1     2     3     4     5     6     7     8     9    10    11    12    14 
## 0.075 0.285 0.160 0.190 0.095 0.035 0.040 0.045 0.030 0.010 0.020 0.005 0.005 
##    17 
## 0.005</code></pre>
</div>
<div id="hw7" class="section level2">
<h2>hw7</h2>
</div>
<div id="section-22" class="section level2">
<h2>1</h2>
<p>Consider a model P(Y = 1 | X1, X2, X3) =$ $, where X1 ∼ P(1), X2 ∼
Exp(1)and X3 ∼ B(1, 0.5).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>; f0[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>) </span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0[<span class="dv">1</span>]</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>}</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>))</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -3.16674  0.00000  9.00000</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>a[<span class="dv">1</span>]<span class="ot">&lt;-</span>solution<span class="sc">$</span>root</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>; f0[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>) </span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0[<span class="dv">2</span>]</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>}</span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>))</span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -6.07429  0.00000  9.00000</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>a[<span class="dv">2</span>]<span class="ot">&lt;-</span>solution<span class="sc">$</span>root</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>; f0[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>) </span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0[<span class="dv">3</span>]</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>}</span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>))</span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##     root   f.root     iter 
## -8.72501  0.00000 10.00000</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>a[<span class="dv">3</span>]<span class="ot">&lt;-</span>solution<span class="sc">$</span>root</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1 <span class="ot">&lt;-</span> <span class="dv">0</span>; b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>; f0[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fl">0.0001</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>) </span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a><span class="fu">mean</span>(p) <span class="sc">-</span> f0[<span class="dv">4</span>]</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>}</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">2</span>))</span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##      root    f.root      iter 
## -11.31574   0.00000  11.00000</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>a[<span class="dv">4</span>]<span class="ot">&lt;-</span>solution<span class="sc">$</span>root</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">plot</span>(a,f0)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQZgCQ2/+2ZgC225C2/7a2///bkDrb////tmb/25D//7b//9v///+xFzBuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFJElEQVR4nO3d4XKbRgAAYeLYrZS4UROKZb3/ixY4uVYzhj0Zjjtgv5lk/INAvHPAgRhUXTSqyv0fKJ2BgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBwMyBqtXIFWje1SVwbWOgAdXNn+h/MPP2S1a9/b1woPt37UxyBUq1utkZiHgMIp7F4hgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIeNMeOIKAgYCBgIGAgYCBQKJAp4dfl5enqvryY5bVZZQmUN/njzbO+fh9htXllCTQ+XhoIz12P9Zf/5m8uqwSBfp+eX0+dD827ViaurqsEu1i7eipHUHDzseHX/0QaoaO0jsP1JYJl6SPM60uH+dBwEAgUaDX57CLDZzDdh+org7hh+bth0mryylJoOscqONp/iM3FxhOFD/iCCJ1dR1Cvx+DvGl/dT6GDAPjZ/cjaPHVpWMgkDpQvbuzGM6RZ95ubvcG4jnyzNvN7c5AETOcmbeb252BIubIvd1erEaOoB1frA7OkW/t+lID58gXL1bRjkdQOzbO34Y+Tn7HO+J2Ax1iAu34YrV+v2ExaS692UDt4IgZQfNtNzev5oGBgIGAD5IDRxAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEDAQMBAwEPCmPXAEAQMBAwEDAQMBA4FEgQp6TnrilCJNoIKek64mbmzrT7lWU7eWJFBBz0mXGcgRRAp6TrrIY1BRz0kXeRZbfHXpGAhsf6I4UdaJ4v2Hh+XvtOU8zd9/gpl6SvqEjBPF+6cokyc1n5BxBO04UNzbX/YcKG6iuN9jUOzqdnsWW3516aQONPj2l9VIHOiz4jYX+Z+adWWJ/nmazRlolqVKDDT5NUwbDzT9NUzbDjTDa5i2HSj2NUyTN7fWQI4gEvUaphk2t9pAUa9h2pjVXDzlYiBgIGAgYCBgIGAgYCBgIGAgYCBgILBkoJc/+5tIzcjXkAbde0EHvobzf+t7GvkquFunCRfXCwbqvgDwEr7+b/ArAHt1twQXatpf+3yMKNRMufuwXKAm3OsPd91OI7/X6/MjLHFdrFvR0CeYN87HVQRqqkN/n/blqRsaY79XZKD+G3Fj1F//WkOgy/VGdvi9Ru9px+1izcPPYxVxZ7Pd4EqOQaFKOPyMH4T4MH7pjuTt6sJoG9PtiVsLFL5ym8ZG/QWHYr9YG2dVgXgX46NULywQFh7Wb67wQN2s5v0Lokd//X5RHmNhsRBo+FDdL/X2qvWIadXHFh9BfJoPCXHfCR9jRn2CWfgI+k8TOVGMOwb1R5ebzzLHVriqQN3Qh3PUqYo5f/dfPB31AeZaAq2SgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBQPGBTlMeD5tB6YG6R9FqfuQ1ncIDnb/94Ac1kyo8UKfJuo+VHqiuqoe/HUGD+r3LXWxYeDjfXWxQN3jOx8++jGcOhQcKzwyfMp7nSw+UnYGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgYCBgIGAgcC/SYwz6bWyrfAAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-23" class="section level2">
<h2>2</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2).For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p>sol:The standard Laplace density is <span class="math display">\[
f(x)=\frac{1}{2} e^{-|x|}
\]</span> and <span class="math display">\[
r\left(x_t,
y\right)=\frac{f(y)}{f\left(x_t\right)}=\frac{e^{-|y|}}{e^{-\left|x_t\right|}}=e^{\left|x_t\right|-|y|}
.
\]</span></p>
<p>In the generator rw.Laplace below, <span class="math inline">\(\mathrm{N}\)</span> is the length of the chain to
generate, <span class="math inline">\(\mathrm{x}
0=\mathrm{x}[1]\)</span> is the initial value and sigma is the standard
deviation of the normal proposal distribution. At each step, the
candidate point is generated from <span class="math inline">\(N\left(\mu_t, \sigma^2\right)\)</span>, where
<span class="math inline">\(\mu_t=X_t\)</span> is the previous value in
the chain. The return value is a list containing the generated chain
<span class="math inline">\(\$ \mathrm{x}\)</span> and the number of
rejected points.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a> rw.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigma) {</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(xt) <span class="sc">-</span> <span class="fu">abs</span>(y)))</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a>  }</span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>  }</span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a> <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">k =</span> k))</span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a> }</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a> N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a> sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a> x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a> rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Laplace</span>(N, x0, sigma[<span class="dv">1</span>])</span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a> rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Laplace</span>(N, x0, sigma[<span class="dv">2</span>])</span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a> rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Laplace</span>(N, x0, sigma[<span class="dv">3</span>])</span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a> rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Laplace</span>(N, x0, sigma[<span class="dv">4</span>])</span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k))</span></code></pre></div>
<pre><code>## [1]  848 1489 2326 3372</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a> <span class="fu">cat</span>(<span class="st">&quot;rejection rates &quot;</span>, (<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>N), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## rejection rates  0.1696 0.2978 0.4652 0.6744</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a> y1 <span class="ot">&lt;-</span> rw1<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a> y2 <span class="ot">&lt;-</span> rw2<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a> y3 <span class="ot">&lt;-</span> rw3<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a> y4 <span class="ot">&lt;-</span> rw4<span class="sc">$</span>x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Based on the plots above, a short burn-in sample of size 100 is
discarded from each chain. Each of the chains appear to have converged
to the target Laplace distribution. Chains 2 and 3 corresponding to σ =
1, 2 have the best fits based on the QQ plots. The second chain is the
more efficient of these two.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a> burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a> X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a> rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a> mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a> sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a> s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a> s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a> X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a> x2 <span class="ot">&lt;-</span> X[i <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a> m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb117-15"><a href="#cb117-15" tabindex="-1"></a> X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb117-16"><a href="#cb117-16" tabindex="-1"></a> x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb117-17"><a href="#cb117-17" tabindex="-1"></a> m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb117-18"><a href="#cb117-18" tabindex="-1"></a> X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb117-19"><a href="#cb117-19" tabindex="-1"></a> }</span>
<span id="cb117-20"><a href="#cb117-20" tabindex="-1"></a> b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb117-21"><a href="#cb117-21" tabindex="-1"></a> x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb117-22"><a href="#cb117-22" tabindex="-1"></a> X <span class="ot">&lt;-</span> x[, <span class="dv">1</span>]</span>
<span id="cb117-23"><a href="#cb117-23" tabindex="-1"></a> Y <span class="ot">&lt;-</span> x[, <span class="dv">2</span>]</span>
<span id="cb117-24"><a href="#cb117-24" tabindex="-1"></a> L <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb117-25"><a href="#cb117-25" tabindex="-1"></a> L</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Coefficients:
## (Intercept)            X  
##   -0.003331     0.889847</code></pre>
<p>The coefficients of the fitted model match the parameters of the
target distribution well.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">plot</span>(X, Y, <span class="at">cex =</span> <span class="fl">0.25</span>)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">plot</span>(L<span class="sc">$</span>fit, L<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.25</span>)</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">qqnorm</span>(L<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.25</span>)</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="fu">qqline</span>(L<span class="sc">$</span>res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot of residuals vs fits suggests that the error variance is
constant with respect to the response variable. The QQ plot of residuals
is consistent with the normal error assumption of the linear model.</p>
</div>
<div id="section-24" class="section level2">
<h2>4</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to R &lt;
1.2. (See Exercise 9.9.) Also use the coda package to check for
convergence of the chain by the Gelman-Rubin method.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a> <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a> <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a> <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a> <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a> }</span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a>Rayleigh.MH.chain1 <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a> x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb124-9"><a href="#cb124-9" tabindex="-1"></a> x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb124-10"><a href="#cb124-10" tabindex="-1"></a> u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb124-11"><a href="#cb124-11" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb124-12"><a href="#cb124-12" tabindex="-1"></a> xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb124-13"><a href="#cb124-13" tabindex="-1"></a> y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb124-14"><a href="#cb124-14" tabindex="-1"></a> num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb124-15"><a href="#cb124-15" tabindex="-1"></a> den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb124-16"><a href="#cb124-16" tabindex="-1"></a> <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den)</span>
<span id="cb124-17"><a href="#cb124-17" tabindex="-1"></a> x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb124-18"><a href="#cb124-18" tabindex="-1"></a> <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb124-19"><a href="#cb124-19" tabindex="-1"></a> }</span>
<span id="cb124-20"><a href="#cb124-20" tabindex="-1"></a> <span class="fu">return</span>(x)</span>
<span id="cb124-21"><a href="#cb124-21" tabindex="-1"></a> }</span>
<span id="cb124-22"><a href="#cb124-22" tabindex="-1"></a> sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb124-23"><a href="#cb124-23" tabindex="-1"></a> x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb124-24"><a href="#cb124-24" tabindex="-1"></a> k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb124-25"><a href="#cb124-25" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb124-26"><a href="#cb124-26" tabindex="-1"></a> X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb124-27"><a href="#cb124-27" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) X[i, ] <span class="ot">&lt;-</span> <span class="fu">Rayleigh.MH.chain1</span>(sigma, m,</span>
<span id="cb124-28"><a href="#cb124-28" tabindex="-1"></a> x0[i])</span>
<span id="cb124-29"><a href="#cb124-29" tabindex="-1"></a> psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb124-30"><a href="#cb124-30" tabindex="-1"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i, ] <span class="ot">&lt;-</span> psi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">4</span>, ])</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(X1, X2, X3, X4)</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.02</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(Y, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw8" class="section level2">
<h2>hw8</h2>
</div>
<div id="section-25" class="section level2">
<h2>1</h2>
<p><span class="math inline">\(X_1,\cdots,X_n服从Exp(\lambda).观测值为(u_i,v_i)\)</span><br />
<span class="math inline">\((1)分别用极大化似然和EM算法求解\lambda的MLE,证明算法收敛于观测数据的MLE,且有线性收敛速度.\)</span><br />
<span class="math inline">\((2)观测值分别为(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3),变成实现上述方法的数值解.\)</span></p>
<p><span class="math inline">\(sol:\)</span> (1)<br />
<span class="math display">\[
\begin{aligned}
&amp; L(\lambda|u_i,v_i)=\Pi_{i=1}^nP_{\lambda}(u_i\leq X_i\leq
v_i)=\Pi_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i})=\Pi _{i=1} ^{n}
e^{-\lambda u_{i} }(1-e^{\lambda (u_{i}-v_{i})})\\   
&amp; 取对数，l(\lambda|u_i,v_i)=\sum_{i=1}^n[-\lambda
u_i+\log(1-e^{\lambda(u_i-v_i)})] \\
&amp;
求导得到l^\prime(\lambda|u_i,v_i)=\sum_{i=1}^n[-u_i+\frac{(u_i-v_i)\exp(\lambda(u_i-v_i))}{\exp(\lambda(u_i-v_i))-1}]  \\
&amp; l^\prime(\lambda)=0的点即为估计值  \\
&amp; 假设真实数据为X=(X_1,\cdots,X_n)\\
&amp; 则l(\lambda|u_i,v_i,X)=n\log(\lambda)-\lambda\sum_{i=1}^n x_i \\
&amp;
E_{\lambda_0}[l(\lambda|u_i,v_i,X)|u_i,v_i]=n\log(\lambda)-\lambda\sum_{i=1}^n[u_i+\frac{1}{\hat{\lambda_0}}-\frac{(u_i-v_i)\exp(\hat{\lambda_0}(u_i-v_i))}{\exp(\hat{\lambda_0}(u_i-v_i))-1}]
\\
&amp;
可知\hat{\lambda_1}=\frac{n}{\sum_{i=1}^n[u_i+\frac{1}{\hat{\lambda_0}}-\frac{(u_i-v_i)\exp(\hat{\lambda_0}(u_i-v_i))}{\exp(\hat{\lambda_0}(u_i-v_i))-1}]}\\
&amp;
将\hat{\lambda_0}和\hat{\lambda_1}替换成\lambda.可以看到收敛值与直接极大化似然函数求导后结果相同，因此EM算法收敛到观测数据的MLE
\\
&amp;
记f(x)=\frac{n}{\sum_{i=1}^n[u_i+\frac{1}{x}-\frac{(u_i-v_i)\exp(x(u_i-v_i))}{\exp(x(u_i-v_i))-1}]}
\\
&amp;
则f^\prime(\lambda_{\infty})=1-n^{-1}\lambda_{\infty}^2\sum_{i=1}^n\frac{(u_i-v_i)^2\exp(\lambda_{\infty}(u_i-v_i))}{(\exp(\lambda_{\infty}(u_i-v_i)))^2},即0&lt;f^\prime(\lambda_{\infty})&lt;1,因此具有线性收敛速度.
\\
\end{aligned}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(u)</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="sc">-</span>n<span class="dv">-10</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.0001</span>,<span class="dv">10</span>))</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>s1<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07196826</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>l0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="cf">while</span> (l1 <span class="sc">-</span> l0 <span class="sc">&gt;</span> <span class="fl">0.00001</span> <span class="sc">|</span> k<span class="sc">&lt;</span><span class="dv">10000</span>) {</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a>  l0 <span class="ot">&lt;-</span> l1</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>  l1 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(n<span class="sc">+</span><span class="dv">10</span><span class="sc">/</span>l0<span class="sc">+</span><span class="dv">10</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>l0)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>l0)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a>}</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a>l1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>二者结果几乎相同。</p>
</div>
<div id="section-26" class="section level2">
<h2>2</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute B &lt;- A + 2, find the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a> min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a> A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a> max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a> A <span class="ot">&lt;-</span> A<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a> it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a> a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a> A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a> b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a> A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a> b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a> sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a> <span class="at">maxi =</span> <span class="cn">TRUE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a> a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a> A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a> b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a> A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a> b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a> sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a> <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a> soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">A =</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A, <span class="at">x =</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],<span class="at">y =</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n], <span class="at">v =</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span></span>
<span id="cb132-24"><a href="#cb132-24" tabindex="-1"></a> min.A)</span>
<span id="cb132-25"><a href="#cb132-25" tabindex="-1"></a>soln }</span>
<span id="cb132-26"><a href="#cb132-26" tabindex="-1"></a> A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb132-27"><a href="#cb132-27" tabindex="-1"></a> <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb132-28"><a href="#cb132-28" tabindex="-1"></a> <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">5</span>,</span>
<span id="cb132-29"><a href="#cb132-29" tabindex="-1"></a> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb132-30"><a href="#cb132-30" tabindex="-1"></a> <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>,</span>
<span id="cb132-31"><a href="#cb132-31" tabindex="-1"></a> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb132-32"><a href="#cb132-32" tabindex="-1"></a> <span class="fu">library</span>(boot)</span>
<span id="cb132-33"><a href="#cb132-33" tabindex="-1"></a> B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb132-34"><a href="#cb132-34" tabindex="-1"></a> s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb132-35"><a href="#cb132-35" tabindex="-1"></a> s[<span class="dv">4</span>]</span></code></pre></div>
<pre><code>## $v
## x10 
##   2</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a> <span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a> <span class="fu">round</span>(s<span class="sc">$</span>x <span class="sc">*</span> <span class="dv">61</span>, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>The value of the game is v = 2.</p>
</div>
<div id="hw9" class="section level2">
<h2>hw9</h2>
</div>
<div id="section-27" class="section level2">
<h2>1</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p>sol:因为unlist把列表转化为原子向量，而as.vector函数只能转化矩阵这类数据类型，不能转换列表。</p>
</div>
<div id="section-28" class="section level2">
<h2>2</h2>
<p>What does dim() return when applied to a vector?</p>
<p>sol:会返回NULL值.</p>
</div>
<div id="section-29" class="section level2">
<h2>3</h2>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<p>sol:会返回TRUE值.</p>
</div>
<div id="section-30" class="section level2">
<h2>4</h2>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<p>sol:输出的矩阵里会自动转化成character类型输出.</p>
</div>
<div id="section-31" class="section level2">
<h2>5</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p>sol:可以，可以同时构造0列0行的dataframe.</p>
</div>
<div id="section-32" class="section level2">
<h2>6</h2>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame?How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>}</span></code></pre></div>
<p>sol:对列调用：scale01(数据框名[,第几列])</p>
<p>对所有数据调用：scale01(数据框名)</p>
</div>
<div id="section-33" class="section level2">
<h2>7</h2>
<p>Use vapply() to: a) Compute the standard deviation of every column in
a numeric data frame. b) Compute the standard deviation of every numeric
column in a mixed data frame. (Hint: you’ll need to use vapply()
twice.)</p>
<p>sol: (a)</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">y=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">3</span>))</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 1.290994 3.872983</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">y=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>))</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion</code></pre>
<pre><code>##        x        y 
## 1.290994       NA</code></pre>
</div>
<div id="section-34" class="section level2">
<h2>8</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0
\leq y \leq 1 .
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">size =</span> n)</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> y[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">size =</span> n)</span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>}</span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>xb <span class="ot">&lt;-</span> x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">table</span>(xb)<span class="sc">/</span><span class="fu">length</span>(xb)</span>
<span id="cb144-15"><a href="#cb144-15" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb144-16"><a href="#cb144-16" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, i) <span class="sc">*</span> <span class="fu">beta</span>(i <span class="sc">+</span> a, n<span class="sc">-</span>i<span class="sc">+</span> b)<span class="sc">/</span><span class="fu">beta</span>(a, b)</span>
<span id="cb144-17"><a href="#cb144-17" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(f1, fx), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##        0     1     2     3     4     5     6     7     8     9    10
## f1 0.070 0.106 0.143 0.151 0.142 0.122 0.099 0.076 0.054 0.028 0.010
## fx 0.066 0.110 0.135 0.144 0.140 0.126 0.105 0.080 0.054 0.030 0.011</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
